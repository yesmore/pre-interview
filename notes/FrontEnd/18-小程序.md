# wx小程序开发基础

### 1.介绍

#### 1.[微信⼩程序介绍](https://developers.weixin.qq.com/miniprogram/introduction/)

微信⼩程序，简称[⼩程序](https://baike.baidu.com/item/小程序)，英⽂名 **Min**i **Program** ，是⼀种不需要下载安装即可使⽤的应⽤，它实现了应⽤“触⼿可及”的梦想，⽤⼾扫⼀扫或搜⼀下即可打开应⽤

#### 2.为什么是微信小程序

\1. 微信有海量⽤⼾，⽽且粘性很⾼，在微信⾥开发产品更容易触达⽤⼾；

\2. 推⼴app 或公众号的成本太⾼。

#### 3. 开发适配成本低。

\4. 容易⼩规模试错，然后快速迭代。

\5. 跨平台。



![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps6.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps7.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps8.png)2016年1⽉11⽇，微信之⽗张⼩⻰时隔多年的公开亮相，解读了微信的四⼤价值观。张⼩⻰指出，越来越多产品通过公众号来做，因为这⾥开发、获取⽤⼾和传播成本更低。拆分出来的服务号并没有    提供更好的服务，所以微信内部正在研究新的形态，叫「微信⼩程序」  需要注意的是，之前是叫做应⽤号

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps9.png)2016年9⽉21⽇，微信⼩程序正式开启内测。在微信⽣态下，触⼿可及、⽤完即⾛的微信⼩程序引起⼴泛关注。腾讯云正式上线微信⼩程序解决⽅案，提供⼩程序在云端服务器的技术⽅案。

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps10.png)2017年1⽉9⽇，微信推出的“⼩程序”正式上线。“⼩程序”是⼀种⽆需安装，即可使⽤的⼿机“应⽤”。不需要像往常⼀样下载App，⽤⼾在微信中“⽤完即⾛”。



\1. 微信⽉活已经达到10.82亿。其中55岁以上的⽤⼾也达到6300万

\2. 信息传达数达到450亿，较去年增⻓18%;视频通话4.1亿次,增⻓100%

\3. ⼩程序覆盖超过200+⾏业，交易额增⻓超过6倍，服务1000亿+⼈次,创造出了5000亿+的商业价值

#### 11. ⽀付宝⼩程序

\12. 百度⼩程序

\13. QQ⼩程序

#### 14. 今⽇头条 + 抖⾳⼩程序

[⼩程序⽰例源码](https://github.com/wechat-miniprogram/miniprogram-demo)

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps15.png) |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps16.png) 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps17.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps18.png)拼多多滴滴出⾏

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps19.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps20.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps21.png)欢乐⽃地主智⾏⽕⻋票唯品会

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps22.png)。。。



### 2.环境准备

开发微信⼩程序之前，必须要准备好相应的环境

#### 2.1 注册账号

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps25.png)建议使用全新的邮箱，没有注册过其他小程序或者公众号的。

访问[注册⻚⾯](https://mp.weixin.qq.com/wxopen/waregister?action=step1)，耐⼼完成注册即可。

#### 2.2 获取AppID

由于后期调⽤微信⼩程序的接⼝等功能，需要索取开发者的⼩程序中的 **APPID** ，所以在注册成功后， 可登录，然后获取APPID。

[登录](https://mp.weixin.qq.com/)，成功后可看到如下界⾯

然后复制你的APPID,悄悄的保存起来，不要给别⼈看到�。

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps27.png) |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps28.jpg) 

#### 2.3 开发工具

[下载地址](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps30.png) |

 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps31.png)微信⼩程序⾃带开发者⼯具，集 开发 预览 调试 发布 于⼀⾝的 完整环境。

但是由于编码的体验不算好，因此 建议使⽤ **v**s **code** + **微信小程序编辑工具** 来实现编码

**v**s **code** 负责敲代码， **微信编辑工具** 负责预览



###  3.第一个小程序

注意 第⼀次登录的时候 需要扫码登录

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps34.png) |

#### 3.1 新建项目

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps36.png) 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps40.jpg) 



### 4.开发者工具介绍

详细的使⽤，可以查看[官⽹](https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html)

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps42.png) 

### 5.小程序结构目录

[⼩程序框架](https://developers.weixin.qq.com/miniprogram/dev/framework/MINA.html)的⽬标是通过尽可能简单、⾼效的⽅式让开发者可以在微信中开发具有原⽣ APP 体验的服务。

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps44.png)⼩程序框架提供了⾃⼰的视图层描述语⾔ **WXML** 和 **WXSS** ，以及 **JavaScript** ，并在视图层与逻辑层间提供了数据传输和事件系统，让开发者能够专注于数据与逻辑。

#### 5.1 对比传统

| 结构 | 传统web    | 微信⼩程序 |
| ---- | ---------- | ---------- |
| 结构 | HTML       | WXML       |
| 样式 | CSS        | WXSS       |
| 逻辑 | Javascript | Javascript |
| 配置 | ⽆         | JSON       |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps46.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps47.png)通过以上对⽐得出，传统web 是三层结构。⽽微信⼩程序 是四层结构，多了⼀层



#### 5.2 基本的项目目录

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps49.jpg) 



###  6. 小程序配置文件

⼀个⼩程序应⽤程序会包括最基本的两种配置⽂件。⼀种是全局的 **app.json** 和 ⻚⾯⾃⼰的**page.json**

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps51.png)注意：配置文件中不能出现注释

####  6.1 全局配置app.json

- 普通快速启动项目

**app.json** 是当前⼩程序的全局配置，包括了⼩程序的所有⻚⾯路径、界⾯表现、⽹络超时时间、底部 tab 等。普通快速启动项⽬⾥边的 **app.json** 配置



![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps55.png)

 

- 字段的含义

  **pages** 字段 ⸺ ⽤于描述当前⼩程序所有⻚⾯路径，这是为了让微信客⼾端知道当前你的⼩程序⻚⾯定义在哪个⽬录。

  **window** 字段 ⸺ 定义⼩程序所有⻚⾯的顶部背景颜⾊，⽂字颜⾊定义等。

  完整的配置信息请参考 [app.json配置](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html)

  ##### tabbar字段

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps58.png) 

 

####  6.2 页面配置page.json

这⾥的  **page.json** 其实⽤来表⽰⻚⾯⽬录下的  **page.json**  这类和⼩程序⻚⾯相关的配置。

开发者可以独⽴定义每个⻚⾯的⼀些属性，如顶部颜⾊、是否允许下拉刷新等等。

⻚⾯的配置只能设置 **app.json** 中部分 **window** 配置项的内容，⻚⾯中配置项会覆盖 **app.json**的 **window** 中相同的配置项。

| 属性                         | 类型     | 默认值  | 描述                                                         |
| ---------------------------- | -------- | ------- | ------------------------------------------------------------ |
| navigationBarBackgroundColor | HexColor | #000000 | 导航栏背景颜⾊，如 **#000000**                               |
| navigationBarTextStyle       | String   | white   | 导航栏标题颜⾊，仅⽀持 **black** / **white**                 |
| navigationBarTitleText       | String   |         | 导航栏标题⽂字内容                                           |
| backgroundColor              | HexColor | #ffffff | 窗⼝的背景⾊                                                 |
| backgroundTextStyle          | String   | dark    | 下拉 loading 的样式，仅⽀持 **dark** / **light**             |
| enablePullDownRefresh        | Boolean  | false   | 是否全局开启下拉刷新。 详⻅ [Page.onPullDownRefresh](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#onpulldownrefresh) |
| onReachBottomDistance        | Number   | 50      | ⻚⾯上拉触底事件触发时距⻚⾯底部距离，单位为px。 详⻅[Page.onReachBottom](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#onreachbottom) |
| disableScroll                | Boolean  | false   | 设置为 **true** 则⻚⾯整体不能上下滚动；只在⻚⾯配置中有效，⽆法在 **app.json** 中设置该项 |

 

####  6.3 sitemap配置（了解）

⼩程序根⽬录下的 **sitemap.json** ⽂件⽤于配置⼩程序及其⻚⾯是否允许被微信索引。



###  7.模板语法

> WXML（WeiXin Markup Language）是框架设计的⼀套标签语⾔，结合[基础组件](https://developers.weixin.qq.com/miniprogram/dev/component/index.html)、[事件系统](https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html)，可以构建出⻚⾯的结构。

#### 7.1 数据绑定

- 普通写法

`<view> {{ }} </view>` 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps68.png)

- 组件属性

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps70.png)

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps71.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps73.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps74.png) 

> 注意：
>
> 字符串与花括号之间不要存在空格，否则会识别失败
>
> 如：
>
> *checked*="   {{ !isCheck }}"



#### 7.2 运算

- 三元运算

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps77.png)

- 算术运算

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps79.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps80.png)

- 逻辑判断

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps82.png)

- 字符串运算

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps84.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps85.png) 

> 注意:
>
> 花括号和引号之间如果有空格，将最终被解析成为字符串



#### 7.3 列表渲染

- **wx: for**

项的变量名默认为  **item**	**wx:for-**item 可以指定数组当前元素的变量名下标变量名默认为  **index**		

**wx:for-**index 可以指定数组当前下标的变量名

**wx:key** ⽤来提⾼数组渲染的性能

**wx:key** 绑定的值 有如下选择

**1.** **string** 类型，表⽰ 循环项中的唯⼀属性 如

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps89.png)

 

**2. **保留字 **this** ，它的意思是 **item** 本⾝ ，*this 代表的必须是 唯⼀的字符串和数组。 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps90.png)

代码：

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps92.png)

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps93.png)

 ```html
8 列表循环
    1 wx:for="{{数组或者对象}}"  wx:for-item="循环项的名称"  wx:for-index="循环项的索引"
    2 wx:key="唯一的值" 用来提高列表渲染的性能
      1 wx:key 绑定一个普通的字符串的时候 那么这个字符串名称 肯定是 循环数组 中的 对象的 唯一属性
      2 wx:key ="*this"  就表示 你的数组 是一个普通的数组  *this 表示是 循环项 
        [1,2,3,44,5]
        ["1","222","adfdf"]
    3 当出现 数组的嵌套循环的时候 尤其要注意  以下绑定的名称 不要重名
        wx:for-item="item" wx:for-index="index"
    4 默认情况下 我们 不写
       wx:for-item="item" wx:for-index="index"
       小程序也会把 循环项的名称 和 索引的名称 定义为 item 和 index 
       只有一层循环的话 （wx:for-item="item" wx:for-index="index"） 可以省略

  9 对象循环
    1 wx:for="{{对象}}" wx:for-item="对象的值"  wx:for-index="对象的属性"
    2 循环对象的时候 最好把 item和index的名称都修改一下
      wx:for-item="value"  wx:for-index="key"
 ```

- **block**

渲染⼀个包含多节点的结构块 block最终不会变成真正的dom元素

*1 占位符的标签* 

 *2 写代码的时候 可以看到这标签存在*

 *3 页面渲染 小程序会把它移除掉*

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps95.png) |



#### 7.4 条件渲染

- wx：if

在框架中，使⽤ **wx:if="{{condition}}"** 来判断是否需要渲染该代码块：

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps98.png)

- hidden

  类似 v-show

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps100.png) 

- 使用条件

  *1 当标签不是频繁的切换显示 优先使用 wx:if*

  ​     *直接把标签从 页面结构给**移除**掉* 

  *2 当标签频繁的切换显示的时候 优先使用 hidden*

  ​     *通过**添加样式**的方式来切换显示* 

  ​     ***hidden 属性 不要和 样式 display一起使用***（display：none会被覆盖）



### 8.小程序事件的绑定 

⼩程序中绑定事件，通过bind关键字来实现。如  **bindtap**	**bindinput**	**bindchange** 等不同的组件⽀持不同的事件，具体看组件的说明即可。

#### 8.1 wxml

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps105.png)

#### 8.2 page

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps107.png) 

#### 8.3 注意

1. ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps109.png)绑定事件时不能带参数 不能带括号 以下为错误写法

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps110.png) |

2. 事件传值 通过标签⾃定义属性的⽅式 和 **value**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps111.png) |

3. 事件触发时获取数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps112.png) |

- 计数器案例

*1 需要给input标签绑定 input事件* 

  *绑定关键字 bindinput*

 *2 如何获取 输入框的值* 

  *通过事件源对象来获取* 

  *e.detail.value* 

 *3 把输入框的值 赋值到 data当中*

  *不能直接* 

   *1 this.data.num=e.detail.value* 

   *2 this.num=e.detail.value* 

  *正确的写法*

   *this.setData({*

​    *num:e.detail.value* 

   *})*

 *4 需要加入一个点击事件* 

   *1 bindtap*

   *2 无法在小程序当中的 事件中 直接传参* 

   *3 通过自定义属性的方式来传递参数*

   *4 事件源中获取 自定义属性*



### 9.wxss

> WXSS( **WeiXi**n **Styl**e **Sheets** )是⼀套样式语⾔，⽤于描述 **WXML** 的组件样式。与 CSS 相⽐，WXSS 扩展的特性有：
>
> - 响应式⻓度单位 **rpx**
>
> - 样式导⼊

#### 9.1 尺寸单位 

**rpx** （responsive pixel）: 可以根据屏幕宽度进⾏**⾃适应**。规定屏幕宽为 **750rpx** 。如在**iPhone6** 上，屏幕宽度为 **375px** ，共有750个物理像素，则 **750rp**x **=** **375p**x **=** **750物理像素**， **1rp**x **= **0.5p**x **= **1物理像素** 。

| 设备         | rpx换算px (屏幕宽度/750) | px换算rpx (750/屏幕宽度) |
| ------------ | ------------------------ | ------------------------ |
| iPhone5      | 1rpx = 0.42px            | 1px = 2.34rpx            |
| iPhone6      | 1rpx = 0.5px             | 1px = 2rpx               |
| iPhone6 Plus | 1rpx = 0.552px           | 1px = 1.81rpx            |

建议： 开发微信⼩程序时设计师可以⽤ iPhone6 作为视觉稿的标准。使⽤步骤：

1. 确定设计稿宽度 pageWidth

2. 计算⽐例 **750rp**x **=** **pageWidt**h **px** ,因此 **1px=750rpx/pageWidth** 。

3. 在less⽂件中，只要把设计稿中的 **px** => **750/pageWidt**h **rpx** 即可。

```css
1 小程序中 不需要主动来引入样式文件 
2 需要把页面中某些元素的单位 由 px 改成 rpx
  1 设计稿 750x
    750 px = 750 rpx 
    1 px = 1 rpx
  2 把屏幕宽度 改成 375px
    375 px = 750 rpx
    1 px = 2rpx
    1rpx = 0.5px
3 存在一个设计稿 宽度 414 或者 未知 page 
  1 设计稿 page 存在一个元素 宽度 100px
  2 拿以上的需求 去实现 不同宽度的页面适配 

  page px = 750 rpx
  1 px = 750 rpx / page
  100 px = 750 rpx * 100 / page 
  假设  page =  375px
4 利用 一个属性 calc属性  css 和 wxss 都支持 一个属性
  1 750 和 rpx 中间不要留空格
  2 运算符的两边也不要留空格
```



#### 9.2 样式导入 

wxss中直接就⽀持，样式导⼊功能。也可以和 less中的导⼊混⽤。

- 相对路径：

  ​	使⽤ **@import** 语句可以导⼊外联样式表，**只⽀持相对路径**。

- ⽰例代码：

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps125.png) |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps126.png)

#### 9.3 选择器

特别需要注意的是 ⼩程序 不⽀持通配符 ***** 因此以下代码⽆效！

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps128.png) |

⽬前⽀持的选择器有：

| 选择器           | 样例                   | 样例描述                                       |
| ---------------- | ---------------------- | ---------------------------------------------- |
| .class           | **.intro**             | 选择所有拥有 class= intro 的组件               |
| #id              | **#firstname**         | 选择拥有 id= firstname 的组件                  |
| element          | **view**               | 选择所有 view 组件                             |
| element, element | **view,** **checkbox** | 选择所有⽂档的 view 组件和所有的 checkbox 组件 |
| nth-child(n)     | view:nth-child(n)      | 选择某个索引的标签                             |
| ::after          | **view::after**        | 在 view 组件后边插⼊内容                       |
| ::before         | **view::before**       | 在 view 组件前边插⼊内容                       |

#### 9.4 小程序中使用Less

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps130.png) 

原⽣⼩程序不⽀持 **less** ，其他基于⼩程序的框架⼤体都⽀持，如 **wepy** ，  **mpvue** ，  **taro** 等。但是仅仅因为⼀个less功能，⽽去引⼊⼀个框架，肯定是不可取的。因此可以⽤以下⽅式来实现

1. 编辑器是 **vscode**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps131.png) |

   2.安装插件 **eas**y **less**

3. *在vs code的设置中加⼊如下，配置

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps132.png) |

4. 在要编写样式的地⽅，新建 **less** ⽂件，如 **index.less** ,然后正常编辑即可。

> 注意:
>
> *1 less中 支持 两种注释 多行 单行*
>
>  *2 wxss 不能写 单行注释 因为 写了 和没写是一样！！！*
>
>   **/*
>
>  */\* font-size: 200px; \*/*
>
>  *// font-size: 400px;*



### 10.[常⻅组件](https://developers.weixin.qq.com/miniprogram/dev/component/)

重点讲解⼩程序中常⽤的布局组件

**view, text, rich**-text, button, image, navigator, icon, swiper, radio, checkbox 等



#### 10.1 view

代替 原来的 **div** 标签

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps136.png) |



####  10.2 text

• ⽂本标签

• **只能嵌套text**

• ⻓按⽂字可以复制（只有该标签有这个功能）

• 可以对空格 回⻋ 进⾏编码

| 属性名                     | 类型    | 默认值 | 说明         |
| -------------------------- | ------- | ------ | ------------ |
| selectable                 | Boolean | false  | ⽂本是否可选 |
| 已改成*user-select*="text" |         |        |              |
| decode                     | Boolean | false  | 是否解码     |



##### 10.2.1 代码

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps140.png) 



####  10.3 image

1. 图⽚标签，image组件默认宽度**320px**、⾼度**240px**

2. ⽀持懒加载

   当 图片 出现在 视口  上下 三屏的高度 之内的时候  自己开始加载图片 

| 属性名    | 类型    | 默认值      | 说明                 |
| --------- | ------- | ----------- | -------------------- |
| src       | String  |             | 图⽚资源地址         |
| mode      | String  | scaleToFill | 图⽚裁剪、缩放的模式 |
| lazy-load | Boolean | false       | 图⽚懒加载           |

mode 有效值：

​	mode 有 13 种模式，其中 4 种是缩放模式，9 种是裁剪模式。

| 模式 | 值           | 说明                                                        |
| ---- | ------------ | ----------------------------------------------------------- |
| 缩放 | scaleToFill  | 不保持纵横⽐缩放图⽚，使图⽚的宽⾼完全拉伸⾄填满 image 元素 |
| 缩放 | aspectFit    | 保持纵横⽐缩放图⽚，使图⽚的⻓边能完全显⽰出来。            |
| 缩放 | aspectFill   | 保持纵横⽐缩放图⽚，只保证图⽚的短边能完全显⽰出来。        |
| 缩放 | widthFix     | 宽度不变，⾼度⾃动变化，保持原图宽⾼⽐不变                  |
| 裁剪 | top          | 不缩放图⽚，只显⽰图⽚的顶部区域                            |
| 裁剪 | bottom       | 不缩放图⽚，只显⽰图⽚的底部区域                            |
| 裁剪 | center       | 不缩放图⽚，只显⽰图⽚的中间区域                            |
| 裁剪 | left         | 不缩放图⽚，只显⽰图⽚的左边区域                            |
| 裁剪 | right        | 不缩放图⽚，只显⽰图⽚的右边区域                            |
| 裁剪 | top left     | 不缩放图⽚，只显⽰图⽚的左上边区域                          |
| 裁剪 | top right    | 不缩放图⽚，只显⽰图⽚的右上边区域                          |
| 裁剪 | bottom left  | 不缩放图⽚，只显⽰图⽚的左下边区域                          |
| 裁剪 | bottom right | 不缩放图⽚，只显⽰图⽚的右下边区域                          |

```javascript
image 图片标签
  1 src 指定要加载的图片的路径
    图片存在默认的宽度和高度 320 * 240      原图大小是 200 * 100
  2 mode 决定 图片内容 如何 和 图片标签 宽高 做适配
    1 scaleToFill 默认值 不保持纵横比缩放图片，使图片的宽高完全拉伸至填满 image 元素 
    2 aspectFit 保持宽高比 确保图片的长边 显示出来   页面轮播图 常用
    3 aspectFill 保持纵横比缩放图片，只保证图片的 短 边能完全显示出来。  少用
    4 widthFix 以前web的图片的 宽度指定了之后 高度 会自己按比例来调整   常用  
    5 bottom。。 类似以前的backgroud-position 
  3 小程序当中的图片 直接就支持 懒加载  lazy-load
    1 lazy-load 会自己判断 当 图片 出现在 视口  上下 三屏的高度 之内的时候  自己开始加载图片 
```





####  10.4 swiper

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps148.png)微信内置轮播图组件

*1 轮播图外层容器 swiper*

 *2 每一个轮播项 swiper-item*

 *3 swiper标签 存在默认样式*

  	*1 width 100%*
  	
  	 *2 height 150px  image 存在默认宽度和高度 320 \* 240* 
  	
  	 *3 swiper 高度 无法实现由内容撑开* 

 *4 先找出来 原图的宽度和高度 等比例 给swiper 定 宽度和高度*

 	 *原图的宽度和高度 1125 \* 352 px*

​	  *swiper 宽度 / swiper 高度 = 原图的宽度 / 原图的高度*

  	*swiper 高度 = swiper 宽度 \* 原图的高度 / 原图的宽度*
  	
  	*height: 100vw \* 352 / 1125*



<img src="file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps150.png" alt="img" style="zoom:33%;" /> 

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps151.png) |

| 属性名                 | 类型    | 默认值            | 说明                 |
| ---------------------- | ------- | ----------------- | -------------------- |
| indicator-dots         | Boolean | false             | 是否显⽰⾯板指⽰点   |
| indicator-color        | Color   | rgba(0, 0, 0, .3) | 指⽰点颜⾊           |
| indicator-active-color | Color   | #000000           | 当前选中的指⽰点颜⾊ |
| autoplay               | Boolean | false             | 是否⾃动切换         |
| interval               | Number  | 5000              | ⾃动切换时间间隔     |
| circular               | Boolean | false             | s是否循环轮播        |

#####  10.4.1 swiper

​	滑块视图容器。

##### 10.4.0 swiper-item

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps154.png)滑块

默认宽度和⾼度都是100%



#### 10.5 [navigator](https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html)

- 导航组件 类似**超链接**标签

- 默认为块级元素

| 属性名     | 类型   | 默认值   | 说明                                                         |
| ---------- | ------ | -------- | ------------------------------------------------------------ |
| target     | String | self     | 在哪个⽬标上发⽣跳转，默认当前⼩程序，可选值self/miniProgram |
| url        | String |          | 当前⼩程序内的跳转链接                                       |
| open- type | String | navigate | 跳转⽅式                                                     |



target 要跳转到当前的小程序 还是其他的小程序的页面

- self 默认值 自己 小程序的页面*

- miniProgram 其他的小程序的页面



 open-type有效值：

| 值           | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| navigate     | 保留当前⻚⾯，跳转到应⽤内的某个⻚⾯，但是不能跳到 tabbar ⻚⾯ |
| redirect     | 关闭当前⻚⾯，跳转到应⽤内的某个⻚⾯，但是不允许跳转到 tabbar ⻚⾯。 |
| switchTab    | 跳转到 tabBar ⻚⾯，并关闭其他所有⾮ tabBar ⻚⾯             |
| reLaunch     | 关闭所有⻚⾯，打开到应⽤内的某个⻚⾯                         |
| navigateBack | 关闭当前⻚⾯，返回上⼀⻚⾯或多级⻚⾯。可通过 [getCurrentPages() ](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/route.html#getcurrentpages)获取当前的⻚⾯栈，决定需要返回⼏层 |
| exit         | 退出⼩程序，target= miniProgram 时⽣效                       |

 

#### 10.6 [rich-text](https://developers.weixin.qq.com/miniprogram/dev/component/rich-text.html)

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps164.png)富文本标签

可以将字符串解析成 对应标签，类似 vue中 **v-html** 功能

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps165.png) 

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps167.png) 



#####  10.6.1 nodes属性

**nodes** 属性⽀持 **字符串** 和 **标签节点数组**

| 属性     | 说明       | 类型   | 必填 | 备注                                     |
| -------- | ---------- | ------ | ---- | ---------------------------------------- |
| name     | 标签名     | string | 是   | ⽀持部分受信任的 HTML 节点               |
| attrs    | 属性       | object | 否   | ⽀持部分受信任的属性，遵循 Pascal 命名法 |
| children | ⼦节点列表 | array  | 否   | 结构和 nodes ⼀致                        |

文本节点：text=type

| 属性 | 说明 | 类型   | 必填 | 备注         |
| ---- | ---- | ------ | ---- | ------------ |
| text | ⽂本 | string | 是   | ⽀持entities |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps173.png)**nodes** 不推荐使⽤ **String** 类型，性能会有所下降。

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps176.png)**rich-text** 组件内屏蔽所有节点的事件。**attrs** 属性不⽀持 id ，⽀持 class 。**name** 属性⼤⼩写不敏感。

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps177.png)如果使⽤了不受信任的 **HTML** 节点，该节点及其所有⼦节点将会被移除。

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps178.png)**img** 标签仅⽀持⽹络图⽚。

 

####  10.7 [button](https://developers.weixin.qq.com/miniprogram/dev/component/button.html)

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps181.png) |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps182.png) 

| 属性       | 类型    | 默认值  | 必填 | 说明                                                         |
| ---------- | ------- | ------- | ---- | ------------------------------------------------------------ |
| size       | string  | default | 否   | 按钮的⼤⼩                                                   |
| type       | string  | default | 否   | 按钮的样式类型                                               |
| plain      | boolean | false   | 否   | 按钮是否镂空，背景⾊透明                                     |
| disabled   | boolean | false   | 否   | 是否禁⽤                                                     |
| loading    | boolean | false   | 否   | 名称前是否带 loading 图标                                    |
| form- type | string  |         | 否   | ⽤于 [`` ](https://developers.weixin.qq.com/miniprogram/dev/component/form.html)组件，点击分别会触发 [`` ](https://developers.weixin.qq.com/miniprogram/dev/component/form.html)组件的submit/reset 事件 |
| open- type | string  |         | 否   | 微信开放能⼒                                                 |



 **size 的合法值**

| 值      | 说明     |
| ------- | -------- |
| default | 默认⼤⼩ |
| mini    | ⼩尺⼨   |

**type的合法值**

| 值      | 说明 |
| ------- | ---- |
| primary | 绿⾊ |
| default | ⽩⾊ |
| warn    | 红⾊ |

 **form-type的合法值**

| 值     | 说明     |
| ------ | -------- |
| submit | 提交表单 |
| reset  | 重置表单 |

**open-type的合法值**

| 值             | 说明                                                         |
| -------------- | ------------------------------------------------------------ |
| contact        | 打开客服会话，如果⽤⼾在会话中点击消息卡⽚后返回⼩程序，可以从bindcontact 回调中获得具体信息，[具体说明](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/customer-message/customer-message.html) |
| share          | 触发⽤⼾转发，使⽤前建议先阅读[使⽤指引](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/share.html#使用指引) |
| getPhoneNumber | 获取⽤⼾⼿机号，可以从bindgetphonenumber回调中获取到⽤⼾信息， [具体说明](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/getPhoneNumber.html) |
| getUserInfo    | 获取⽤⼾信息，可以从bindgetuserinfo回调中获取到⽤⼾信息      |
| launchApp      | 打开APP，可以通过app-parameter属性设定向APP传的参数[具体说明](https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/launchApp.html) |
| openSetting    | 打开授权设置⻚                                               |
| feedback       | 打开“意⻅反馈”⻚⾯，⽤⼾可提交反馈内容并上传[⽇志](https://developers.weixin.qq.com/miniprogram/dev/api/wx.getLogManager.html)，开发者可以登录[⼩程序管理后台](https://mp.weixin.qq.com/)后进⼊左侧菜单“客服反馈”⻚⾯获取到反馈内容 |

**getPhoneNumber** 获取当前用户的手机号码信息 结合一个事件来使用 不是企业的小程序账号 没有权限来获取用户的手机号码

  *1 绑定一个事件 bindgetphonenumber* 

  2 在事件的回调函数中 通过参数来获取信息* 

  *3 获取到的信息 已经加密过了* 

  	 *需要用户自己待见小程序的后台服务器，在后台服务器中进行解析 手机号	码，返回到小程序中 就可以看到信息了*

**getUserInfo** 获取当前用户的个人信息

  *1 使用方法 类似 获取用户的手机号码*

  *2 可以直接获取 不存在加密的字段* 

**launchApp** 在小程序当中 直接打开 app

  *1 需要现在 app中 通过app的某个链接 打开 小程序*

  *2 在小程序 中 再通过 这个功能 重新打开 app*

  *3 找到 京东的app 和 京东的小程序* 

**openSetting** 打开小程序内置的 授权页面

  *1 授权页面中 只会出现 用户曾经点击过的 权限* 

**feedback** 打开 小程序内置的 意见反馈页面

  *1 只能够通过真机调试来打开* 



 **open-type的contact的实现流程**

• 将⼩程序 的 **appid** 由测试号改为 ⾃⼰的 **appid**

• 登录[微信⼩程序官⽹](https://mp.weixin.qq.com/)，添加 **客**服 **-** **微信**

• 为了⽅便演⽰，⽼师⾃⼰准备了两个账号

• 普通⽤⼾ A

• 客服-微信 B

•就是⼲！

 

####  10.8 icon

| 属性  | 类型          | 默认值 | 必填 | 说明                                                         |
| ----- | ------------- | ------ | ---- | ------------------------------------------------------------ |
| type  | string        |        | 是   | icon的类型，有效值：success, success_no_circle, info, warn, waiting, cancel, download, search, clear |
| size  | number/string | 23     | 否   | icon的⼤⼩                                                   |
| color | string        |        | 否   | icon的颜⾊，同css的color                                     |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps195.png) 

js

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps198.png) |

wxml

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps200.png) |

 

#### 10.9 [radio单选框标签](https://developers.weixin.qq.com/miniprogram/dev/component/radio.html)

可以通过 color属性来修改颜色

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps204.png) |

需要搭配 [radio-group ](https://developers.weixin.qq.com/miniprogram/dev/component/radio-group.html)⼀起使⽤



#### 10.10 checkbox复选框标签

可以通过 color属性来修改颜色

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps208.png) |

需要搭配 [checkbox-group ](https://developers.weixin.qq.com/miniprogram/dev/component/checkbox-group.html)⼀起使⽤

 



### 11.  [⾃定义组件](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/)

> 类似vue或者react中的自定义组件

⼩程序允许我们使⽤⾃定义组件的⽅式来构建⻚⾯。

 

#### 11.1 创建自定义组件

> 类似于页面，一个自定义组件由 **json** **wxml** **wxss** **js** 4个文件组成

可以在微信开发者⼯具中快速创建组件的⽂件结构

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps214.png) |

在⽂件夹内 **components/myHeader** ，创建组件 名为 **myHeader**

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps215.jpg) 

######  11.1.1 声明组件

⾸先需要在组件的 **json** ⽂件中进⾏⾃定义组件声明

**myHeader.json**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps217.png) |



###### 11.1.2 编辑软件

同时，还要在组件的 **wxml** ⽂件中编写组件模板，在 **wxss** ⽂件中加⼊组件样式

**slot** 表⽰插槽，类似vue中的slot

**myHeader.wxml**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps219.png) |

在组件的 **wxss** ⽂件中编写样式

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps220.png)注意：在组件wxss中不应使用ID选择器、属性选择器和标签名选择器。

**myHeader.wxss**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps221.png) |

 

###### 11.1.3 注册组件

在组件的 **js** ⽂件中，需要使⽤ **Component()** 来注册组件，并提供组件的属性定义、内部数据和

⾃定义⽅法

**myHeader.js**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps223.png) |

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps224.png)

 



####  11.2 声明引入自定义组件

⾸先要在⻚⾯的 **json** ⽂件中进⾏引⽤声明。还要提供对应的组件名和组件路径

**index.wxml**

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps226.png) |



#### 11.3 页面中使用自定义组件

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps228.png)



#### 11.4 其他属性

*1 页面.js 文件中 存放事件回调函数的时候 存放在data同层级下！！！*

 *2 组件.js 文件中 存放事件回调函数的时候 必须要存在在 methods中！！！*



#### 11.5 定义段与实例方法

**Component** 构造器可⽤于定义组件，调⽤ **Component** 构造器时可以指定组件的属性、数据、⽅法等。

| 定义段     | 类型       | 是否必填 | 描述                                                         |
| ---------- | ---------- | -------- | ------------------------------------------------------------ |
| properties | Object Map | 否       | （父传子）组件的对外属性，是属性名到属性设置的映射表，参⻅下⽂ |
| data       | Object     | 否       | 组件的内部数据，和 **properties** ⼀同⽤于组件的模板渲染     |
| observers  | Object     | 否       | 组件数据字段监听器，⽤于监听 properties 和 data 的变化，参⻅ [数据监听器](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/observer.html) |
| methods    | Object     | 否       | 组件的⽅法，包括事件响应函数和任意的⾃定义⽅法，关于事件响应函数的使⽤，参⻅ [组件事件](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/events.html) |
| created    | Function   | 否       | 组件⽣命周期函数，在组件实例刚刚被创建时执⾏，注意此时不能调⽤ **setData** ，参⻅ [组件⽣命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html) |
| attached   | Function   | 否       | 组件⽣命周期函数，在组件实例进⼊⻚⾯节点树时执⾏，参⻅ [组件⽣命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html) |
| ready      | Function   | 否       | [组件⽣命周期函数，在组件布局完成后执⾏，参⻅ 组件⽣命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html) |
| moved      | Function   | 否       | 组件⽣命周期函数，在组件实例被移动到节点树另⼀个位置时执⾏，参⻅ [组件⽣命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html) |
| detached   | Function   | 否       | 组件⽣命周期函数，在组件实例被从⻚⾯节点树移除时执⾏，参⻅ [组件⽣命周期](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html) |

 

####  11.6 组件-自定义组件传参

• ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps232.png)⽗组件通过属性的⽅式给⼦组件传递参数

• ⼦组件通过事件的⽅式向⽗组件传递参数

> *1 父组件(页面) 向子组件 传递数据 通过 标签属性的方式来传递*
>
>   *1 在子组件上进行接收*
>
>   *2 把这个数据当成是data中的数据直接用即可*
>
>  *2 子向父传递数据 通过事件的方式传递*
>
>   *1 在子组件的标签上加入一个 自定义事件*

  

###### 11.6.1 过程

1. ⽗组件 把数据 **{{tabs}}** 传递到 ⼦组件的 **tabItems** 属性中

2. ⽗组件 监听 **onMyTab** 事件

3. ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps236.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps237.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps238.png)⼦ 组 件 触 发 **bindmytap** 中的	事件

   • ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps239.png)⾃定义组件触发事件时，需要使⽤⽅法，指定 **事件名** 、 **detail** 对象

4. ⽗ -> ⼦ 动态传值 **this.selectComponent("#tabs")**;



父组件代码

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps241.png)子组件代码![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps243.png) 



#### 11.7 小结

1. 标签名 是 中划线的⽅式

2. 属性的⽅式 也是要中划线的⽅式

3. 其他情况可以使⽤驼峰命名

   • 组件的⽂件名如 **myHeader.js** 的等

   • 组件内的要接收的属性名 如  **innerText**

4. [更多。。](https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/component.html)





###  12 小程序生命周期

分为**应⽤⽣命周期**和**⻚⾯⽣命周期**

> 关于小程序前后台的定义和小程序的运行机制，请参考[运行机制](https://developers.weixin.qq.com/miniprogram/dev/framework/operating-mechanism.html)章节。



#### 12.1 应用生命周期

| 属性                                                         | 类型     | 默认值 | 必填 | 说明                     |
| ------------------------------------------------------------ | -------- | ------ | ---- | ------------------------ |
| [onLaunch](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onlaunchobject-object) | function |        | 否   | 监听⼩程序初始化。       |
| [onShow](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onshowobject-object) | function |        | 否   | 监听⼩程序启动或切前台。 |
| [onHide](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onhide) | function |        | 否   | 监听⼩程序切后台。       |
| [onError](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onerrorstring-error) | function |        | 否   | 错误监听函数。           |
| [onPageNotFound](https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onpagenotfoundobject-object) | function |        | 否   | ⻚⾯不存在监听函数。     |

onPageNotFound：

- *应用第一次启动的时候，如果找不到第一个入口页面 才会触发*

* 如果页面不存在了 通过js的方式来重新跳转页面 重新跳到第二个首页
* *不能跳到tabbar页面 导航组件类似* 



####  12.2 页面生命周期

| 属性                                                         | 类型     | 说明                                                         |
| ------------------------------------------------------------ | -------- | ------------------------------------------------------------ |
| [data](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#data) | Object   | ⻚⾯的初始数据                                               |
| [onLoad](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onloadobject-query) | function | ⽣命周期回调?监听⻚⾯加载                                    |
| [onShow](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onshow) | function | ⽣命周期回调?监听⻚⾯显⽰                                    |
| [onReady](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onready) | function | ⽣命周期回调?监听⻚⾯初次渲染完成                            |
| [onHide](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onhide) | function | ⽣命周期回调?监听⻚⾯隐藏                                    |
| [onUnload](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onunload) | function | ⽣命周期回调?监听⻚⾯卸载                                    |
| [onPullDownRefresh](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onpulldownrefresh) | function | 监听⽤⼾下拉动作                                             |
| [onReachBottom](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onreachbottom) | function | ⻚⾯**上拉触底**事件的处理函数                               |
| [onShareAppMessage](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onshareappmessageobject-object) | function | ⽤⼾点击右上⻆转发                                           |
| [onPageScroll](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onpagescrollobject-object) | function | ⻚⾯滚动触发事件的处理函数                                   |
| [onResize](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onresize) | function | ⻚⾯尺⼨改变时触发，详⻅ [响应显⽰区域变化](https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html#在手机上启用屏幕旋转支持) |
| [onTabItemTap](https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#ontabitemtapobject-object) | function | 当前是 tab ⻚时，点击 tab 时触发                             |



#### 12.3 图解页面生命周期

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml20952\wps256.png) 





---



# 项目

### 1.[接⼝⽂档](https://www.showdoc.cc/128719739414963)

### 2.帮助文档

​	1.[⼩程序开发⽂档](https://developers.weixin.qq.com/miniprogram/dev/framework/)

​	2.[mdn](https://developer.mozilla.org/zh-CN/)

3. [阿⾥巴巴字体 iconfont](https://www.iconfont.cn/)

 

### 3.项目搭建

#### 3.1 新建小程序项目

> 填入自己的appid

 

####  3.2 搭建目录结构

| ⽬录名     | 作⽤             |
| ---------- | ---------------- |
| styles     | 存放公共样式     |
| components | 存放组件         |
| lib        | 存放第三⽅库     |
| utils      | ⾃⼰的帮助库     |
| request    | ⾃⼰的接⼝帮助库 |

 

#### 3.3 搭建项目页面

| ⻚⾯名称     | 名称         |
| ------------ | ------------ |
| ⾸⻚         | index        |
| 分类⻚⾯     | category     |
| 商品列表⻚⾯ | goods_list   |
| 商品详情⻚⾯ | goods_detail |
| 购物⻋⻚⾯   | cart         |
| 收藏⻚⾯     | collect      |
| 订单⻚⾯     | order        |
| 搜索⻚⾯     | search       |
| 个⼈中⼼⻚⾯ | user         |
| 意⻅反馈⻚⾯ | feedback     |
| 登录⻚⾯     | login        |
| 授权⻚⾯     | auth         |
| 结算⻚⾯     | pay          |

 

#### 3.4 引入字体图标

1. 打开阿⾥巴巴字体图标 ⽹站

2. 选择的图标

3. 添加⾄项⽬

4. 下载到本地

5. 将样式⽂件 由 css 修改为 wxss

6. ⼩程序中引⼊



####  3.5 搭建项目tabbar结构

参照之前讲解的⼩程序基础中的tabbar知识点

 

### 4.首页

#### 4.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps15.png) 



 

####  4.2 业务逻辑

1. 使⽤**tabbar** 实现底部导航功能

2. 使⽤⾃定义组件的⽅式 实现 **头部搜索框**

3. 加载 **轮播图** 数据

4. 加载 **导航** 数据

5. 加载 **楼层** 数据



####  4.3 接口

1. 获取⾸⻚轮播图数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps21.png) |

2. 获取⾸⻚分类菜单数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps22.png) |

3. 获取⾸⻚ 楼层数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps23.png) |



####  4.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps25.png)⼩程序内置 **reques**t **API**

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps26.png)es6 的 **promise**

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps27.png)⼩程序 **swiper** 组件

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps28.png)⾃定义组件 实现 搜索框

 

### 5.分类页面

#### 5.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps31.png) 



####  5.2 业务逻辑

1. 加载分类⻚⾯数据

2. 点击左侧菜单，右侧数据动态渲染



#### 5.3 接口

1. 分类⻚⾯数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps34.png) |



####  5.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps36.png)**scroll-view** 组 件

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps37.png)es7 的 **async** 和 **await**



#### 5.5 小程序中支持es7的async语法

> es7的 **async** 号称是解决回调的最终⽅案

- 在⼩程序的开发⼯具中，勾选 es6转es5语法
- 下载 facebook的regenerator库中的 [regenerator/packages/regenerator-runtime/runtime.js](https://github.com/facebook/regenerator/blob/5703a79746fffc152600fdcef46ba9230671025a/packages/regenerator-runtime/runtime.js)
- 在⼩程序⽬录下新建⽂件夹 **lib/runtime/runtime.js** ，将代码拷⻉进去
- 在每⼀个需要使⽤async语法的⻚⾯js⽂件中，都引⼊（不能全局引⼊）
- 同时设置详情，选中“**增强编译**”



|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps39.png) |



### 6.商品列表页面

#### 6.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps42.png) 



#### 6.2 业务逻辑

1. 加载商品列表数据

2. 启⽤下拉⻚⾯功能

• ⻚⾯的json⽂件中开启设置 **enablePullDownRefresh:true**

• ⻚⾯的js中，绑定事件 **onPullDownRefresh**

• 启⽤上拉⻚⾯功能 **onReachBottom** ⻚⾯触底事件

• 加载下⼀⻚功能



####  6.3 接口

1. 商品列表搜索

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps46.png) |



####  6.4 关键技术

- ⼩程序配置⽂件中 启⽤**上拉** 和**下拉**功能

- **搜索框**和**tab**栏是⼩程序的**⾃定义组件**(有组件事件和参数交互)

 

###  7.商品详情页面

#### 7.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps57.png) 



####  7.2 业务逻辑

1. 渲染商品详情数据

2. 点击图⽚，[调出图⽚画廊，进⾏预览](https://developers.weixin.qq.com/miniprogram/dev/api/wx.previewImage.html)

3. 点击收藏

4. 联系客服

5. 分享功能

6. 加⼊购物⻋



#### 7.3 接口

1. 获取详情数据接⼝

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps60.png) |

2. 加⼊购物⻋接⼝使⽤**本地存储来维护购物⻋**数据

3. ⽴即购买接⼝ (相当于是 创建订单接⼝)

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps61.png) |



####  7.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps63.png)swiper组件

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps64.png)本地存储实现 收藏功能

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps67.png)联系客服 ⼩程序管理后台中 直接添加即可富⽂本标签 渲染 富⽂本

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps68.png)⼩程序 预览图⽚接⼝



### 8.收藏页

#### 8.1效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps71.jpg) 



 

####  8.2 业务逻辑

1. 获取本地存储中的数据进⾏渲染

2. 点击商品可以跳转到商品详情⻚⾯



####  8.3 接口

⽆

 

####  8.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps75.png)⼩程序 ⾃定义组件

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps76.png)本地存储 加载收藏数据



### 9.购物车页面

#### 9.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps79.jpg) 



####  9.2 业务逻辑

1. 渲染购物⻋数据

2. 添加收货地址

3. 修改商品数量

4. 单选和全选功能



####  9.3 接口

1. 获取购物⻋数据 **本地存储实现**

2. [调⽤微信的收货地址](https://developers.weixin.qq.com/miniprogram/dev/api/wx.chooseAddress.html)

 

####  9.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps83.png)⼩程序 选择收货地址 **api**

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps84.png)⼩程序 复选框 组件



### 10.支付页面

#### 10.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps87.png) 



####  10.2 业务逻辑

1. 获取微信收货地址

2. 渲染购物⻋中要结算的商品

3. 实现⽀付

   • 获取微信的登录信息

   • 获取⾃⼰后台返回的⽀付相关参数

   • 调⽤微信接⼝实现 ⽀付

   • ⽀付成功创建订单

   · 跳转到订单⻚⾯



#### 10.3 支付流程

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps90.png) 



 

####  10.4 接口

1. 获取预⽀付参数

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps92.png) |

2. 创建订单

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps93.png) |

3. 更新订单状态

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps94.png) |

 

####  10.5 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps96.png)⼩程序 ⽀付 api

 

###  11.授权页面

#### 11.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps99.jpg) 



#### 11.2 业务逻辑

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps101.png) 



 

 

1. 获取⽤⼾信息

   返 回 **encryptedData,rawData,iv,signature**

2. ⼩程序登录返 回 **code**

3. 提交数据到⾃⼰ 的后台 执⾏post请求 提交数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps102.png) |

4. 将  **token** 和⽤⼾数据 **rawData** 存⼊本地存储

 

#### 11.3 接口

1. 提交数据到后台 返回token

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps104.png) |

 

### 12.订单列表页面

#### 12.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps107.png) 



 

####  12.2 业务逻辑

1. 根据不同的的状态去加载不同的订单数据

2. 点击标题紧挨着对应数据



####  12.3 接口

1. 查询订单数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps110.png) |

 

####  12.4 关键技术

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps112.png)![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps113.png)⼩程序 ⾃定义组件的  传参  ⽗向⼦动态传参  **this.selectComponent("#tabs")****;** 时间戳 格式化处理

 

### 13.搜索页面

#### 13.1 效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps116.png) 



####  13.2 接口

1. 搜索建议查询

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps118.png) |

 

#### 13.3 业务逻辑

1. 获取输⼊框的值进⾏搜索和渲染

2. 点击 **取消** 按钮时 清除输⼊状态，修改⻚⾯模样

 

####  13.4 关键技术

1. ⼩程序 输⼊框组件

2. 输⼊值改变时，为了提⾼性能，使⽤ **防抖** 技术



### 14.个人中心页面

#### 14.1效果

![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps125.png) 

 

####  14.2 业务逻辑

1. 获取登录信息

2. 加载收藏信息

3. 查询订单状态



####  14.3 接口

1. [获取⽤⼾信息](https://developers.weixin.qq.com/miniprogram/dev/api/wx.getUserInfo.html?search-key=getuser)

2. 获取收藏数据 **从本地存储中获取**

3. 获取订单数据

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps128.png) |

 

#### 14.4 关键技术

1. [css属性filter的使⽤](https://www.runoob.com/cssref/css3-pr-filter.html)



### 15 意见反馈页面

#### 15.1 效果![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps132.png) 



####  15.2 业务逻辑

1. 点击 **+** 可以选择本地图⽚，并且显⽰到⻚⾯上

2. 点击 **提交** 可以上传图⽚到 接⼝ 地址 新浪图床 上

|      |                                                              |
| ---- | ------------------------------------------------------------ |
|      | ![img](file:///C:\Users\86136\AppData\Local\Temp\ksohtml18760\wps135.png) |

3. 点击图⽚，会移除⾃⼰

4. 点击 tab栏的标题，可以切换选中效果

 

####  15.3 接口

⽆

 

####  15.4 关键技术

1. ⾃定义组件 tab

2. ⾃定义组件 图⽚删除组件

3. ⼩程序 上传⽂件 api

